------------------------------------------------------------------------

# 프로젝트_아보카도_설계서_250915

------------------------------------------------------------------------

## **1. 시스템 아키텍처 설계서**

### **1.1. 시스템 구성도**

본 시스템은 사용자 인터페이스, 비즈니스 로직, AI 모델, 데이터 저장소로
구성된다.

-   **프론트엔드 (React)** 사용자에게 텍스트 입력, 음성 모델 선택, 결과
    확인 기능을 제공한다.
-   **백엔드 (Node.js + Express)** API 서버로 동작하며 회원 관리, 텍스트
    변환 요청 처리, 데이터 관리 기능을 담당한다.
-   **AI 모델 (Python + PyTorch + Coqui XTTS)** 텍스트-음성 변환 및
    사용자 음성 기반 커스텀 모델 생성을 수행한다.
-   **데이터베이스 (MySQL)** 사용자 정보, 음성 모델 정보, 변환 결과
    기록을 저장한다.
-   **스토리지 (로컬 기반 → 확장 가능)** 변환된 음성 파일(.wav, .mp3)을
    저장한다. 초기에는 로컬 저장소를 활용하며, 추후 필요 시 클라우드
    스토리지(AWS S3, GCP Storage 등)로 확장한다.

------------------------------------------------------------------------

### **1.2. 핵심 기술**

-   **Coqui XTTS** 고품질 사전 학습 모델을 기반으로 TTS 기능을 구현한다.
-   **스피커 임베딩 방식** 사용자의 발음을 그대로 학습하지 않고,
    톤·음색·고유 음성 특징만 추출하여 모델에 적용한다. → 결과: "깨끗한
    발음 + 사용자의 목소리 톤"

------------------------------------------------------------------------

### **1.3. 데이터 흐름**

1.  **기본 TTS** 사용자가 텍스트를 입력하면, 백엔드는 선택된 기본 화자
    모델과 함께 AI 모델에 전달한다. 합성된 음성 파일은 저장소에
    저장되고, DB에는 파일 경로가 기록된다.
2.  **커스텀 모델 생성** 사용자가 음성 파일을 업로드하면, AI 모델의
    스피커 인코더가 음색 임베딩 벡터를 생성한다. 이 벡터는 DB에 저장되어
    사용자 계정과 매핑된다.
3.  **커스텀 TTS** 사용자가 "내 목소리 모델"을 선택하여 텍스트를
    입력하면, 해당 임베딩을 불러와 AI 모델에서 합성을 수행한다.

------------------------------------------------------------------------

## **2. 데이터 설계서**

### **2.1. 데이터 모델 (ERD 요약)**

-   **User**

    -   id (PK)
    -   email
    -   pw
    -   name
    -   age
    -   gender
    -   customVoiceId (FK)

-   **VoiceModel**

    -   id (PK)
    -   type (기본/커스텀)
    -   name
    -   features (성별, 톤 등)
    -   createdBy (FK)

-   **OutputVoice**

    -   id (PK)
    -   userId (FK)
    -   text
    -   modelId (FK)
    -   fileUrl
    -   createdAt

### **2.2. 관계**

-   User ↔ VoiceModel: 1:1 (사용자 1명 = 커스텀 모델 최대 1개)
-   User ↔ OutputVoice: 1:N (사용자별 다수 결과 생성 가능)
-   VoiceModel ↔ OutputVoice: 1:N (모델은 여러 결과에 활용 가능)

------------------------------------------------------------------------

## **3. 화면 설계서**

### **3.1. 화면 흐름도**

로그인 화면 → 메인 화면(탭 구조) → ① 텍스트 변환 탭 ② 결과 확인 탭 ③ 내
음성 모델 탭 ④ 설정 탭 ⑤ 마이페이지

### **3.2. 주요 화면 구성**

-   **텍스트 변환 탭**

    -   텍스트 입력창
    -   모델 선택 드롭다운
    -   변환 버튼
    -   결과 재생·다운로드

-   **결과 확인 탭**

    -   변환 기록 리스트 (텍스트, 모델, 파일)
    -   검색 및 필터링
    -   결과물 공유

-   **내 음성 모델 탭**

    -   음성 업로드 인터페이스
    -   업로드 상태 표시
    -   생성 완료 후 "내 목소리 모델" 저장 및 미리듣기

-   **설정 탭**

    -   사용자 정보 확인 및 수정 (이메일, 비밀번호 변경 등 기본 기능
        위주)

------------------------------------------------------------------------

## **4. 기능 설계서**

### **4.1. 회원 관리 기능**

-   FR-1.01 회원가입
-   FR-1.02 로그인
-   FR-1.03 사용자 정보 조회
-   FR-1.04 비밀번호 재설정 (이메일 인증 기반, 간단 구현 가능)

### **4.2. 텍스트-음성 변환 기능**

-   FR-2.01 텍스트 입력
-   FR-2.02 모델 선택 (기본 3종 + 커스텀)
-   FR-2.03 음성 변환
-   FR-2.04 음성 재생
-   FR-2.05 음성 다운로드
-   FR-2.06 음성 공유 (이메일 전송)

### **4.3. 커스텀 음성 모델 생성 기능**

-   FR-3.01 실시간 녹음(최소 20문장 이상 권장)
-   FR-3.02 업로드 가이드 제공
-   FR-3.03 파일 유효성 검사 (길이, 품질)
-   FR-3.04 스피커 임베딩 추출
-   FR-3.05 모델 저장

### **4.4. 결과 관리 기능**

-   FR-4.01 변환 기록 확인
-   FR-4.02 기록 상세 조회
-   FR-4.03 기록 삭제

------------------------------------------------------------------------

## **5. 인터페이스 설계서**

### **5.1. API 명세**

-   **사용자**

    -   `POST /api/register`
    -   `POST /api/login`
    -   `GET /api/user/:id`

-   **음성 모델**

    -   `GET /api/models`
    -   `POST /api/models/custom`

-   **텍스트-음성 변환**

    -   `POST /api/convert`
    -   `GET /api/output/:id`

### **5.2. 요청/응답 예시**

-   `POST /api/convert`

``` json
{
  "text": "안녕하세요, 아보카도입니다.",
  "modelId": "custom_user_123"
}
```

-   `GET /api/output/output_456`

``` json
{
  "id": "output_456",
  "status": "completed",
  "filename": "output_20250912_001.wav",
  "url": "<http://localhost/storage/output_20250912_001.wav>",
  "duration": "3.2s"
}
```

------------------------------------------------------------------------

## **6. 테스트 설계서**

### **6.1. 테스트 시나리오**

-   **회원 시나리오**: 회원가입 → 로그인 → 정보 조회 → 비밀번호 재설정
-   **기본 TTS 시나리오**: 텍스트 입력 → 모델 선택 → 변환 요청 → 결과
    확인 및 다운로드
-   **커스텀 모델 시나리오**: 음성 파일 업로드 → 임베딩 추출 진행 → 모델
    저장 → 텍스트 변환 실행
-   **결과 관리 시나리오**: 변환 기록 확인 → 검색/필터링 → 삭제

### **6.2. 성능 요구사항 검증**

-   TTS 변환 속도: 10초 이내
-   커스텀 모델 생성: 10분 이내
-   API 응답 시간: 3초 이내

### **6.3. 음성 품질 평가**

-   **평가**: MOS(자연스러움, 명료성, 화자 유사성, 의견 수렴)

------------------------------------------------------------------------

## **7. 향후 확장 고려**

-   클라우드 스토리지 이전 (AWS S3 등)
-   실시간 변환(STT+TTS 연동)
-   다국어 지원
-   보안 강화(JWT 인증, 비밀번호 암호화)

------------------------------------------------------------------------